<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Game Hub</title>

<style>
:root{
  --bg:#020617;
  --panel:rgba(2,6,23,.75);
  --btn:#020617;
  --hover:#334155;
  --text:white;
  --blur:blur(14px);
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:Segoe UI,Arial;
  background:var(--bg);
  color:var(--text);
  overflow:hidden;
}

/* ===== PARTICLE BG ===== */
canvas{
  position:fixed;
  inset:0;
  z-index:0;
}

/* ===== GLASS ===== */
.glass{
  backdrop-filter:var(--blur);
  background:var(--panel);
}

/* ===== TOP BAR ===== */
.top-bar{
  height:52px;
  display:flex;
  align-items:center;
  gap:10px;
  padding:0 15px;
  z-index:5;
  position:relative;
}

.top-bar input,
.top-bar select{
  background:#1e293b;
  border:none;
  border-radius:8px;
  color:white;
  padding:6px 10px;
}

/* ===== GRID ===== */
.grid{
  position:relative;
  z-index:1;
  height:calc(100vh - 52px);
  padding:20px;
  display:grid;
  grid-template-columns:repeat(6,1fr);
  gap:18px;
  overflow:auto;
}

.game{
  border-radius:18px;
  overflow:hidden;
  cursor:pointer;
  position:relative;
  background:var(--btn);
  transition:.15s;
}

.game:hover{
  transform:scale(1.05);
  background:var(--hover);
  box-shadow:0 0 20px rgba(56,189,248,.45);
}

.game img{
  width:100%;
  height:84%;
  object-fit:cover;
}

.title{
  height:16%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:bold;
  background:rgba(0,0,0,.7);
  color:white;
}

.star{
  position:absolute;
  top:10px;
  right:10px;
  font-size:20px;
  cursor:pointer;
  color:white;
}

.star.active{color:gold}

/* ===== GAME VIEW ===== */
.viewer{
  display:none;
  flex-direction:column;
  height:100vh;
  z-index:2;
}

iframe{
  flex:1;
  border:none;
}

/* ===== BUTTONS ===== */
button{
  background:#1e293b;
  border:none;
  color:white;
  border-radius:8px;
  padding:6px 12px;
  cursor:pointer;
}

button:hover{background:#334155}

/* ===== MODALS ===== */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.7);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:9999;
}

.modal-box{
  background:#020617;
  padding:20px;
  border-radius:14px;
  width:340px;
  color:white;
}

.modal-box input{
  width:100%;
  margin-bottom:8px;
  padding:6px;
  background:#1e293b;
  border:none;
  color:white;
}

textarea{
  width:100%;
  height:90px;
  background:#020617;
  color:white;
  border:none;
  margin-top:10px;
}
</style>
</head>
<body>

<canvas id="bg"></canvas>

<!-- TOP BAR -->
<div class="top-bar glass">
  <select id="profileSel"></select>
  <button onclick="newProfile()">‚ûï Profile</button>

  <input placeholder="Search games..." oninput="search(this.value)">

  <button onclick="openBuilder()">‚ûï Add Game</button>
</div>

<!-- GRID -->
<div class="grid" id="grid"></div>

<!-- GAME VIEW -->
<div class="viewer" id="viewer">
  <div class="top-bar glass">
    <button onclick="back()">‚Üê Back</button>
    <span id="timer"></span>
  </div>
  <iframe id="frame"></iframe>
</div>

<!-- GAME BUILDER -->
<div class="modal" id="builderModal">
  <div class="modal-box">
    <h3>Add Game (Code Generator)</h3>

    <input id="bName" placeholder="Game Name">
    <input id="bURL" placeholder="Game URL">
    <input id="bImg" placeholder="Image number (ex: 10)">

    <button onclick="generateCode()">Generate Code</button>
    <button onclick="copyCode()">üìã Copy</button>
    <button onclick="closeBuilder()">Close</button>

    <textarea id="codeOut" readonly></textarea>
  </div>
</div>

<script>
/* ===== PARTICLES ===== */
const c=document.getElementById("bg"),ctx=c.getContext("2d");
function resize(){c.width=innerWidth;c.height=innerHeight}
resize();window.onresize=resize;

let parts=[...Array(90)].map(()=>({
 x:Math.random()*c.width,
 y:Math.random()*c.height,
 vx:Math.random()-.5,
 vy:Math.random()-.5
}));

(function anim(){
 ctx.clearRect(0,0,c.width,c.height);
 ctx.fillStyle="rgba(56,189,248,.4)";
 parts.forEach(p=>{
  p.x+=p.vx; p.y+=p.vy;
  if(p.x<0||p.x>c.width)p.vx*=-1;
  if(p.y<0||p.y>c.height)p.vy*=-1;
  ctx.beginPath();
  ctx.arc(p.x,p.y,2,0,7);
  ctx.fill();
 });
 requestAnimationFrame(anim);
})();

/* ===== GAMES ===== */
const games=[
 {t:"Block Blast",u:"https://kirbscozycavern.neocities.org/blockblast",i:"game1.png"},
 {t:"Learn to Fly 1",u:"https://script.google.com/a/macros/tiftschools.com/s/AKfycbyAW2mW4PFWaL-rMtDJgqiwL0OxsMwtBoiaFgeS_p0_f6VesYcbHDBlxoVBylXcwWrJGg/exec",i:"game2.png"},
 {t:"Learn to Fly 2",u:"https://script.google.com/a/macros/tiftschools.com/s/AKfycbyQ8tw1lAF6zuhWGKqG4hys1Jyw2DEPVK8VapKP-BZsAPqvrRgYThV1bPpT7MYzj3kdHw/exec",i:"game4.png"},
 {t:"Learn to Fly 3",u:"https://script.google.com/a/macros/tiftschools.com/s/AKfycbz8B4YTMrlWe7ul3V8pbgwG4vISWcoX71Y165LYedQWooJtMs8Ox3A9vyXUhEjCiqL-/exec",i:"game5.png"},
 {t:"Dinosaur Game",u:"https://kirbscozycavern.neocities.org/trex",i:"game3.png"},
 {t:"Stack",u:"https://kirbscozycavern.neocities.org/stack",i:"game6.png"},
 {t:"Deltarune",u:"https://kirbscozycavern.neocities.org/deltarune/",i:"game7.png"},
 {t:"Drive Mad",u:"https://kirbscozycavern.neocities.org/drivemad/drivemad",i:"game8.png"},
 {t:"Minecraft",u:"https://kirbscozycavern.neocities.org/minecraft/EaglercraftX_1.8_u50_Offline_Signed",i:"game9.png"}
];

/* ===== PROFILES ===== */
let profiles=JSON.parse(localStorage.getItem("profiles")||"{}");
if(!profiles.Default)profiles.Default={fav:[],time:{},last:null};
let current=localStorage.getItem("currentProfile")||"Default";

function save(){localStorage.setItem("profiles",JSON.stringify(profiles))}

function loadProfiles(){
 profileSel.innerHTML="";
 Object.keys(profiles).forEach(p=>{
  const o=document.createElement("option");
  o.value=p; o.textContent=p;
  if(p===current)o.selected=true;
  profileSel.appendChild(o);
 });
}

profileSel.onchange=e=>{
 current=e.target.value;
 localStorage.setItem("currentProfile",current);
 render();
};

function newProfile(){
 const n=prompt("Profile name?");
 if(!n||profiles[n])return;
 profiles[n]={fav:[],time:{},last:null};
 current=n;
 save(); loadProfiles(); render();
}

/* ===== RENDER ===== */
function render(q=""){
 const p=profiles[current];
 grid.innerHTML="";
 games.filter(g=>g.t.toLowerCase().includes(q.toLowerCase()))
 .forEach(g=>{
  const d=document.createElement("div");
  d.className="game";
  d.innerHTML=`
   <img src="${g.i}">
   <div class="title">${g.t}</div>
   <div class="star ${p.fav.includes(g.t)?"active":""}">‚òÖ</div>`;
  d.onclick=()=>play(g);
  d.querySelector(".star").onclick=e=>{
   e.stopPropagation();
   p.fav.includes(g.t)?p.fav=p.fav.filter(x=>x!==g.t):p.fav.push(g.t);
   save(); render(q);
  };
  grid.appendChild(d);
 });
}

function search(v){render(v)}

/* ===== PLAY ===== */
let startTime=null,currentTitle=null;

function play(g){
 profiles[current].last=g.t;
 startTime=Date.now();
 currentTitle=g.t;
 save();
 grid.style.display="none";
 viewer.style.display="flex";
 frame.src=g.u;
}

function back(){
 if(startTime){
  const s=Math.floor((Date.now()-startTime)/1000);
  profiles[current].time[currentTitle]=(profiles[current].time[currentTitle]||0)+s;
 }
 startTime=null; currentTitle=null;
 save();
 viewer.style.display="none";
 grid.style.display="grid";
 frame.src="";
 render();
}

/* ===== BUILDER ===== */
function openBuilder(){
 document.getElementById("builderModal").style.display="flex";
}
function closeBuilder(){
 document.getElementById("builderModal").style.display="none";
}
function generateCode(){
 if(!bName.value||!bURL.value||!bImg.value)return;
 codeOut.value=`{ t:"${bName.value}", u:"${bURL.value}", i:"game${bImg.value}.png" },`;
}
function copyCode(){
 navigator.clipboard.writeText(codeOut.value);
}

/* INIT */
loadProfiles();
render();
</script>

</body>
</html>
